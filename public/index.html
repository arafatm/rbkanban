<html>
<head>
<link href='css/reset.css' type='text/css' rel='stylesheet'>
<link href='css/layout.css' type='text/css' rel='stylesheet'>
<link href='css/kokanban.css' type='text/css' rel='stylesheet'>
<script src="js/jquery-1.6.1.min.js" type="text/javascript"></script>
<script src="js/jquery.tmpl.js" type="text/javascript"></script>
<script src="js/knockout-1.2.1.js" type="text/javascript"></script>
</head>
<body>
<div id='newfeature'>
  <form data-bind="submit: addFeature">
    <label>New Feature: </label>
    <input id="newFeature" class='newFeature' />
  </form>
</div>
<table border=1>
  <tr data-bind="template: {
    name: 'statuses',
    foreach: statuses }"></tr>
</table>
<!-- Templates -->

<script id="statuses" type="text/html">
<td>
<h2>
<span data-bind="text: $data"></span>
(<span data-bind="text: viewModel.filterByStatus()[$data].length"></span>)
</h2>
<div data-bind="template: { name: 'features', foreach: viewModel.filterByStatus()[$data], afterAdd:  function(elem) { $(elem).hide().fadeIn(2000) } }">
</div>
</td>
</script>

<script id="features" type="text/html">
<div class='feature' data-bind="attr:{ 'class': state }">
  <a class="showComment" data-bind="text: title, click: function(e) { showDetails(e) }" />
  <div class="details" data-bind="visible: false">
    <select data-bind="options: states, value: state" />
    <form data-bind="submit: updateFeature">
      <input id="newComment" class='newComment' />
    </form>
    <div class="comments" data-bind="template: {name: 'comments', foreach: $data.comments}" />
  </div>
  <div class="swim">
    <a data-bind="click: swimBackward, visible: canSwimBackward" class="swim"><--</a>
    <a data-bind="click: swimForward, visible: canSwimForward" class="swim">--></a>
  </div>
</div>
</script>
<script id='comments' type="text/html">
<div class="comment">
<em data-bind="text: createdon" />:
<span data-bind="text: comment" />
</div>
</script>
<div id='readme'>
  <h3>DONE</h3>
  <ul>
    <li>Add 'new feature'</li>
    <li>Swim feature between statuses</li>
    <li>Click on feature to display comments</li>
    <li>Change state of feature between 'Ready', 'Progress', and
    'Impeded'<li> 
    <li>Add a comment</li>
    <li>Changing status or state of feature inserts a comment<li>
  </ul>
  <h3>TODO</h3>
  <ul>
    <li>Simple login</li>
    <li>Mark feature 'Done'</li>
    <li>Assign points</li>
    <li>reset state to 'ready' when changing status</li>
    <li>Authentication (google?)</li>
    <li>Display cycle time</li>
    <li>Seperate 'backlog' vs 'in progress' boards</li>
    <li>Tests</li>
    <li>Push server (websockets?)</li>
    <li>http://timeago.yarp.com/</li>
    <li>Sort features</li>
    <li>filter by state e.g. show impeded</li>
  </ul>
</div>
<!-- Code -->
<script src="js/kokanban.js" type="text/javascript"></script>
<script src="js/seed.js" type="text/javascript"></script>
</body>
</html>
